---
title: "Validate candidates and filter motifs"
author: "Amin Bazaz, Heraldo Borges, Eduardo Ogasawara"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Validate candidates by their occurrences and filter by removing isolated motifs}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

In this step, we have our candidates generated from the original dataset.

## Check the occurrences

We must now validate these candidates. To do this, we will use as a restriction the occurrences.
There are two types of occurrences in our approach : 
- `Global occurrences (GO)`: the number of occurrences in the entire dataset
- `Spatial occurrences (SO)`: the number of spatial-series containing the candidate

The thresholds are used to select from the list of candidates the real motifs

- `Sigma`: threshold to check the minimal number of **global** occurrences of each motif.
- `Kappa`: threshold to check the minimal number of **spatial** occurrences of each motif.

Here an example with three scenarios:

- Scenario 1: kappa = sigma = **4**
- Scenario 2: kappa = sigma = **8**
- Scenario 3: kappa = sigma = **12**

```{r, echo=FALSE, fig.cap="Example of encoded spatial-time series", out.width = '100%'}
knitr::include_graphics("stseries.png")
```

```{r, echo=FALSE, fig.cap="Result of the three scenarios", out.width = '100%'}
knitr::include_graphics("checkOccurences.png")
```

## Filter motifs

Filter motifs by removing isolated motifs and rechecking occurrences.

To find these isolated motifs we use the cluster method.

```{r, echo=FALSE, fig.cap="Cluster method", out.width = '100%'}
knitr::include_graphics("cluster.png")
```

If the motif does not have a neighbor then it is deleted. After that when all isolated motifs are deleted, we recheck like the previous step the occurrences.
