---
title: "Motifs discovery in spatial-time series"
author: "Amin Bazaz, Heraldo Borges, Eduardo Ogasawara"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Motifs discovery in spatial-time series}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This package `STSMotifs` allows to perform a research of motif in spatial-time series. The main purpose is to find a way to handle the issue of large amounts of data. The package offers a way to do this research quickly and efficiently.
To find the motifs, the `Combined Series Approach (CSA)` is used.
The process is decomposed by several steps :

1. Generation of candidates
2. Treatment of candidates
3. Rank the selected candidates

## Input
To use functions of this package, some inputs are needed. The quality of outputs depends strongly by these parameters.

* `dataset` : Dataframe which contains numerics values. Columns represent the space and rows the time.
```{r, echo=FALSE}
data <- STMotif::example_dataset[,1:10]
rownames(data) <- c()
head(data)
```

* `alpha`: The size of the alphabet used to encode the numerical values into a string with SAX.

* `window_size`: The size of the subsequences.

* `tslice` and `sslice`: The size of the blocks.

A part of the process is applied into blocks (subsets of the original dataset). 
With the tslice ("Time slice" number of rows in each block) and sslice ("Space slice" number of columns in each block), the user can specify the block size and the block shape.

* `kappa` : Threshold to check the minimal number of **spatial** occurrences of each motif.

* `sigma` : Threshold to check the minimal number of **global** occurrences of each motif.

## Description of each step

### Generation of candidates

In this step, using tslice and sslice parameters, we create blocks from the original dataset. By using **CSA**, each column of the block are combined to create a single big series. The output of this step is described below.

* For each block:
  - sub dataset
  - sub encoded dataset 
  - candidates found
  - encoded candidates found 
  - position of the block
  - start position of each similar candidate

See more at [Generation of candidates](generation-of-candidates.html)

### Treatment of candidates

This step requires the candidates and the kappa and sigma thresholds.
All the information about candidates are extracted and manipulated. In the end, the candidates that passed the restriction of the two thresholds are stored into a list of motifs. Each motif has as information: 

* the encoded sequence
* the regions in which motif is located
* the coordinates of the starting positions of this motif into the original dataset
* the number of occurrences (global and spacial occurrences)

See more at [Treatment of candidates](validate-candidates.html)



### Rank the selected candidates

The previous step has created a list of motifs with all information about them.
These motifs are ranked by their global and spatial occurrences.
The output is the same as the previous step but ordered.


## Plot the result

There are three ways to visualize the result:

- Plot the intensity of values and highlight one or the top five motifs.

- Plot the spatial-time series by selecting a range of columns in the dataset and highlight one motif.

- Run shiny application to have an interactive interface to visualize the result.
    
    
## Example

To see an example of output : [Output Example](examples.html)



