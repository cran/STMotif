---
title: "Applied process"
author: "Amin Bazaz, Heraldo Borges, Eduardo Ogasawara"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Example with a sample dataset}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


This documentation is intended to present the outputs of a sample dataset.

```{r, echo=FALSE}
source(file = "../R/mainFunction.R")
source(file = "../R/subFunction.R")
source(file = "../R/visualization.R")
library(stats)
library(ggplot2)
library(reshape2)
```

### Launch the workflow to find the motifs

The workflow consists of 3 steps described in the main package documentation.
These 3 steps will be applied on our sample.

 1. The function `NormSAX` allows the normalization and SAX indexing of the dataset:
 
```{r, echo=TRUE}

# The process is launched on the provided example dataset
dim(D <- STMotif::example_dataset)


# Normalizartion and SAX indexing
DS <- NormSAX(D = STMotif::example_dataset,a =7)

# Information of the normalized and SAX indexing dataset 
# The candidates built 
head(NormSAX(D = STMotif::example_dataset, a = 7)[,1:10])

```



2. The function `SearchSTMotifs` allows to check and filter the stmotifs, grouping the motifs from the neighboring block. 


```{r, echo=TRUE}
# The list of motifs 
# stmotifs <- SearchSTMotifs(D,DS,w,a,sb,tb,si,ka)
head(stmotifs <- SearchSTMotifs(D,DS,3,7,10,10,3,10))
```



3. The function `RankSTMotifs` allows to rank the stmotifs list, making a balance between distance among the occurrences of a motif with the encoded information on the motif itself and his quantity. 

```{r, echo=TRUE}
# The rank list of stmotifs 
# rstmotifs <- RankSTMotifs(stmotifs)
head(rstmotifs <- RankSTMotifs(stmotifs))
```


### Plot the result

The function `runVisualization` allows to launch the shiny application to see the result.
There are two ways to visualize the result.

- Plot the intensity of values and highlight one or the top five motifs.

```{r fig, fig.height = 4, fig.width = 6, fig.align = "center"}
# Plot the intensity of the dataset and highlight one selected motif
intensityDataset(dataset = D,rankList = rstmotifs,position = 1,alpha = 7)
```



- Plot the spatial-time series by selecting a range of columns in the dataset and highlight one motif

```{r fig1, fig.height = 4, fig.width = 6, fig.align = "center"}
# Plot five specific spatial-series which some of them contain the best motif
displayPlotSeries(dataset = D, rmotifs = rstmotifs ,position = 1 ,space = c(1,2,5:7))
```


